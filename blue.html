<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
<title>Rosary (Responsive)</title>

<style>
/* --- Basic Styles --- */
* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: sans-serif;
  position: relative;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  min-height: 100vh;
  background-color: #f0f0f0;
  color: #333;
  padding-top: 50px;
  /* overflow: hidden; - Optional if you want to hide scrollbars during zoom */
  user-select: none;
}
h1 {
  color: #333;
  font-size: 2rem;
  margin-bottom: 20px;
}
/* --- Status Bar --- */
#status-bar {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  background-color: #187df5;
  color: white;
  padding: 10px 20px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  font-size: 1.2rem;
  z-index: 300;
  box-shadow: 0 2px 5px rgba(0,0,0,0.5);
}

#prayer-name {
  font-weight: bold;
  color: white;
}

/* --- Main Container (Responsive!) --- */
.rosary-container {
  /* Using viewport units for responsiveness */
  position: absolute;
  width: 90vmin; /* Smaller of vw or vh for responsiveness */
  height: calc(1.5 * 90vmin); /* Aspect ratio 800:1200 = 1:1.5 */
  transition: transform 0.6s cubic-bezier(0.65, 0.05, 0.36, 1);
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  will-change: transform;
  z-index: 100; 
}

/* --- Loop (Circle) --- */
.loop {
  position: absolute;
  top: 0;
  left: 50%;
  transform: translateX(-50%);
  width: 95%; /* 760px / 800px = 95% */
  height: 63.33%; /* 760px / 1200px = 63.33% */
  border-radius: 50%;
}

/* --- Pendant (Lower part) --- */
.pendant {
  position: absolute;
  top: 61.66%; /* 740px / 1200px = 61.66% */
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 1.66vmin; /* Relative gap size */
  z-index: 5;
}

/* --- Bead Styles --- */
.bead {
  border-radius: 50%;
  border: 2px solid #7a5a40;
  transition: all 0.2s ease-in-out;
  cursor: pointer;
  position: relative;
  box-shadow: 2px 2px 6px rgba(0,0,0,0.3);
  will-change: transform, box-shadow;
}

.loop .bead {
  position: absolute;
  transform: translate(-50%, -50%);
}

.pendant .bead {
  position: static;
  transform: none !important;
}

/* Small beads */
.bead.small {
  width: 4.5vmin; /* Scaled size */
  height: 4.5vmin;
  background: radial-gradient(circle at 30% 30%, #394cd4, #1c1cc8);
}

/* Large beads */
.bead.large {
  width: 6.25vmin; /* Scaled size */
  height: 6.25vmin;
  background: radial-gradient(circle at 30% 30%, #3d4097, #223795);
}

/* --- Cross --- */
.cross {
  width: 5vmin; /* 40px */
  height: 15vmin; /* 120px */
  background-color: #8B4513;
  position: relative;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.2s ease-in-out;
  margin-top: 3.75vmin; /* 30px */
  box-shadow: 4px 4px 10px rgba(0,0,0,0.4);
  transform: none !important;
  border: 2px solid #6d4f3a;
}

.cross::before {
  content: '';
  position: absolute;
  top: 30%; /* 36px / 120px */
  left: -60%; /* -24px / 40px */
  width: 205%; /* 82px / 40px */
  height: 20%; /* 24px / 120px */
  background-color: #8B4513;
  border-radius: 6px;
  border: 2px solid #6d4f3a;
}

/* --- Active State (Highlight) --- */
.active {
  box-shadow: 0 0 30px 10px rgba(255, 215, 0, 0.7);
  border-color: #ffd700;
  z-index: 100;
}
.cross.active {
  box-shadow: 0 0 30px 10px rgba(255, 215, 0, 0.7);
  border-color: #ffd700;
}

/* --- Buttons --- */
.controls {
  position: fixed;
  bottom: 40px;
  z-index: 200;
  display: flex;
  gap: 15px;
  /* Centered horizontally on small screens */
  left: 50%;
  transform: translateX(-50%);
  width: 90%; /* Better on small screens */
  justify-content: center;
}

.control-button {
  font-size: 1rem; /* Smaller font on small screens */
  padding: 10px 15px;
  background-color: #fff2b3;
  color: black;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  transition: background-color 0.15s;
  white-space: nowrap;
}
/* Button styles */
#next-bead { background-color: #4CAF50; color: white; }
#next-bead:hover { background-color: #45a049; }
#prev-bead { background-color: #f0f0f0; color: #333; border: 1px solid #ccc; }
#prev-bead:hover { background-color: #e0e0e0; }
#reset-bead { background-color: #dc3545; color: white; }
#reset-bead:hover { background-color: #c82333; }

@media (max-width: 600px) {
  .controls {
    bottom: 20px;
  }
}
</style>
</head>
<body>
<div id="status-bar">
  <span id="prayer-name"></span>
  <span id="counter"></span>
</div>

<div class="rosary-container" id="rosary-container">
  <div class="loop" id="loop-container"></div>
  <div class="pendant" id="pendant-container"></div>
</div>

<div class="controls">
  <button id="prev-bead" class="control-button">‚¨ÖÔ∏è Back</button>
  <button id="next-bead" class="control-button">Next ‚û°Ô∏è</button>
  <button id="reset-bead" class="control-button">Reset</button>
  <button class="control-button" onclick="location.replace('index.html')">üè† Home</button>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {

// --- DOM Elements ---
const rosaryContainer = document.getElementById('rosary-container');
const loopContainer = document.getElementById('loop-container');
const pendantContainer = document.getElementById('pendant-container');
const nextButton = document.getElementById('next-bead');
const prevButton = document.getElementById('prev-bead');
const resetButton = document.getElementById('reset-bead');
const prayerNameEl = document.getElementById('prayer-name');
const counterEl = document.getElementById('counter');
const beadPositions = new Array(61);

// --- Constants for positioning ---
const BASE_WIDTH = 800;
const BASE_HEIGHT = 1200;
const BASE_RADIUS = 340; 
const BASE_LOOP_CENTER_X = 400; 
const BASE_LOOP_CENTER_Y = 380; 
const BASE_PENDANT_TOP_OFFSET = 740;
const BASE_PENDANT_X_CENTER = 400;

const BEAD_SIZE_SMALL_BASE = 36;
const BEAD_SIZE_LARGE_BASE = 50;

// --- Function to calculate scale based on current container size ---
function calculateScaleFactor() {
    const currentWidth = rosaryContainer.offsetWidth;
    return currentWidth / BASE_WIDTH;
}

// --- Generate the Rosary (Responsive) ---
const initialPendantSequence = ['large', 'small', 'small', 'small', 'large'];
const loopSequence = [];
for (let i = 0; i < 5; i++) {
    loopSequence.push('large');
    for (let j = 0; j < 10; j++) {
        loopSequence.push('small');
    }
}
const totalBeads = 61;
let currentBeadIndex = 0;

// Prayer sequence names
const prayerSequenceNames = [
    "Sign of the Cross, I Believe in God", 
    "Our Father (Intro)", 
    "Hail Mary (1/3)", 
    "Hail Mary (2/3)", 
    "Hail Mary (3/3)", 
    "Glory Be / Our Father (Mystery 1)", 
    ...Array.from({length: 5}, (_, i) => [
        `Our Father (Mystery ${i+1})`,
        ...Array(10).fill(`Hail Mary (Decade ${i+1})`),
    ]).flat().slice(0, 55)
];

function generateRosary() {
    // Clear previous content
    loopContainer.innerHTML = '';
    pendantContainer.innerHTML = '';

    const scale = calculateScaleFactor();
    const radius = BASE_RADIUS * scale;
    const centerX = BASE_LOOP_CENTER_X * scale;
    const centerY = BASE_LOOP_CENTER_Y * scale;
    const angleIncrement = (2 * Math.PI) / loopSequence.length;
    const pendantTopOffset = BASE_PENDANT_TOP_OFFSET * scale;
    const pendantXCenter = BASE_PENDANT_X_CENTER * scale;

    // Generate circle beads (indices 6-60)
    loopSequence.forEach((type, index) => {
        const bead = document.createElement('div');
        bead.className = `bead ${type}`;
        const prayerIndex = index + 6;
        bead.dataset.index = prayerIndex;

        const startAngle = (3 * Math.PI / 2) - (angleIncrement * (loopSequence.length / 2)) - angleIncrement;
        const finalAngle = startAngle + (index * angleIncrement);

        const x = centerX + radius * Math.cos(finalAngle);
        const y = centerY + radius * Math.sin(finalAngle);

        bead.style.left = `${x}px`;
        bead.style.top = `${y}px`;
        loopContainer.appendChild(bead);
        beadPositions[prayerIndex] = { x: x, y: y };
    });

    // Generate pendant (indices 0-5)
    const crossElement = document.createElement('div');
    crossElement.className = 'cross';
    crossElement.dataset.index = 0;
    pendantContainer.appendChild(crossElement);

    const pendantBeads = [...initialPendantSequence].reverse();

    pendantBeads.forEach((type, index) => {
        const bead = document.createElement('div');
        bead.className = `bead ${type}`;
        const prayerIndex = pendantBeads.length - index;
        bead.dataset.index = prayerIndex;
        pendantContainer.insertBefore(bead, crossElement);
    });

    // Calculate bead positions in pendant
    const beadsInPendant = pendantContainer.querySelectorAll('.bead');
    let idx = 5;
    beadsInPendant.forEach(beadEl => {
        const beadY = beadEl.offsetTop;
        beadPositions[idx] = {
            x: pendantXCenter,
            y: pendantTopOffset + beadY + (beadEl.offsetHeight / 2)
        };
        idx--;
    });

    // Position of the cross (index 0)
    const crossY = crossElement.offsetTop;
    beadPositions[0] = {
        x: pendantXCenter,
        y: pendantTopOffset + crossY + (crossElement.offsetHeight / 2)
    };

    // Highlight and zoom to current bead
    highlightAndZoom(currentBeadIndex);
}

// --- Interaction & Zooming ---
function updateStatus(index) {
  const prayerName = prayerSequenceNames[index];
  prayerNameEl.textContent = `Current Prayer: ${prayerName}`;
  counterEl.textContent = `Bead: ${index + 1} / ${totalBeads}`;
}

function zoomToActiveBead(index) {
  const scaleFactor = 2.0;
  const pos = beadPositions[index];
  if (!pos) return;

  const containerWidth = rosaryContainer.offsetWidth;
  const containerHeight = rosaryContainer.offsetHeight;

  const targetX = pos.x;
  const targetY = pos.y;

  const centerX = containerWidth / 2;
  const centerY = containerHeight / 2;

  const finalTranslateX = (centerX - targetX) * scaleFactor;
  const finalTranslateY = (centerY - targetY) * scaleFactor;

  rosaryContainer.style.transform = `
    translate(-50%, -50%)
    translate(${finalTranslateX}px, ${finalTranslateY}px)
    scale(${scaleFactor})
  `;
}

function highlightAndZoom(index) {
  const oldActive = document.querySelector('.active');
  if (oldActive) oldActive.classList.remove('active');

  const newActive = document.querySelector(`[data-index="${index}"]`);
  if (newActive) {
    newActive.classList.add('active');
    zoomToActiveBead(index);
    updateStatus(index);
  }
}

function move(direction) {
  if (direction === 'next') {
    currentBeadIndex = (currentBeadIndex + 1) % totalBeads;
  } else if (direction === 'prev') {
    currentBeadIndex = (currentBeadIndex - 1 + totalBeads) % totalBeads;
  } else if (direction === 'reset') {
    currentBeadIndex = 0;
  }
  highlightAndZoom(currentBeadIndex);
}

// --- Event Listeners ---
nextButton.addEventListener('click', () => move('next'));
prevButton.addEventListener('click', () => move('prev'));
resetButton.addEventListener('click', () => move('reset'));

// Keyboard controls
document.addEventListener('keydown', (event) => {
  if (event.key === 'ArrowRight' || event.key === ' ') {
    event.preventDefault();
    move('next');
  } else if (event.key === 'ArrowLeft') {
    move('prev');
  } else if (event.key === 'Escape') {
    move('reset');
  }
});

// Initialize the rosary
generateRosary();

// Re-generate on window resize to adapt
window.addEventListener('resize', () => {
  generateRosary();
  highlightAndZoom(currentBeadIndex);
});
});
</script>
</body>
</html>
